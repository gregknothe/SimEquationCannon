<html>
    <link rel="stylesheet" href="stylesheet.css">
    <head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
    <script src='https://cdn.plot.ly/plotly-2.35.2.min.js'></script>
    </head>


    <body>
        <h1>Simultaneous Equation Cannons</h1>
        <h2>-Visualization-</h2>

        <div id="inputArea">
            <a class="labelText">fusion: </a>
            <input id="fusion" type="text" value="1-5">
            <a class="labelText">xyz: </a>
            <input id="xyz" type="text" value="3-6">
            <button id="button" onclick="runCode()">Calculate</button>
        </div>
        <div id="plot">

        </div>
    </body>
</html>

<script>
    var fusion = document.getElementById("fusion");
    var xyz = document.getElementById("xyz");

    var fusionList = [1,2,3,4,5];
    var xyzList = [3,4,5,6];

    function createList(start, end) {
        var myList = [];
        for (var i = start; i <= end; i++) {
            myList.push(i);
        }
        return myList;
    }

    function createPoints(fusionList, xyzList) {
        var cardCount = [];
        var level = [];
        var label = [];
        for (var f of fusionList) {
            for (var x of xyzList) {
                cardCount.push(Number(f)+Number(x)+Number(x));
                level.push(Number(f)+Number(x));
                label.push(f.toString()+"+"+x.toString());
            }
        }
        return {cardCount, level, label};
    }
    /*---------------------------------Graph---------------------------------------------*/
    var xvalues = [7, 9, 11, 13, 8, 10, 12, 14, 9, 11, 13, 15, 10, 12, 14, 16, 11, 13, 15, 17];
    var yvalues = [4, 5, 6, 7, 5, 6, 7, 8, 6, 7, 8, 9, 7, 8, 9, 10, 8, 9, 10, 11];
    var textValues = ['1+3', '1+4', '1+5', '1+6', '2+3', '2+4', '2+5', '2+6', '3+3', '3+4', '3+5', '3+6', '4+3', '4+4', '4+5', '4+6', '5+3', '5+4', '5+5', '5+6']

    var trace1 = {
    x: xvalues,
    y: yvalues,
    text: textValues,
    mode: 'markers+text',
    textposistion: "top center",
    marker: {
        opacity: 0,
        color: "rgb(255,255,255)",
    },
    textfont: { 
        size: 11,
        color: "rgb(255, 255, 255)",
    },
    type: 'scatter',
    };

    var data = [trace1];

    var layout = {
        xaxis: {
            title: "card count",
            showgrid: true,
            dtick: 1,
            range: [.5,20],
            color: "rgb(255, 255, 255)",
        },
        yaxis: {
            title: "level",
            showgrid: true,
            dtick: 1,
            range: [.5,12.5],
            color: "rgb(255, 255, 255)",
        },
        plot_bgcolor: "rgb(24, 24, 24)",
        paper_bgcolor: "rgb(24, 24, 24)",
        margin: {
            t:0,
            r:0,
            b:40,
            l:40,
        },
        annotations: [{
            x: 2.5,
            y: 12,
            text: "(fusion + xyz)",
            bgcolor: "rgb(24, 24, 24)",
            font: {
                color: "white",
                size: 15,
            },
            showarrow: false,
            borderpad: 4,
        }],
    }

    Plotly.newPlot('plot', [trace1], layout);

    /* -----------------------------------------------------------------------------------*/
    function runCode() {
        fusionList = createList(fusion.value.split("-")[0], fusion.value.split("-")[1]);
        xyzList = createList(xyz.value.split("-")[0], xyz.value.split("-")[1]);
        /*console.log(fusionList);
        console.log(xyzList);*/
        var values = createPoints(fusionList, xyzList); 
        trace1.x = values.cardCount;
        trace1.y = values.level;
        trace1.text = values.label;
        Plotly.redraw('plot', [trace1], layout);
    } 

    /*fusion.addEventListener("change", function(){
        var values = createPoints(fusionList, xyzList);
        xvalues = values.cardCount;
        yvalues = values.level;
    });*/
 
    /* figuyre out how to update plot points without using the button 
    figure out how to set range limits 
    figure out how to set labels per point if possible*/

</script>